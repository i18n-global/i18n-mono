echo "ğŸ” Running pre-push checks..."

# í˜„ì¬ ë¸Œëœì¹˜ í™•ì¸
CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

# main ë¸Œëœì¹˜ë¡œ ì§ì ‘ push ê²½ê³  (CI í™˜ê²½ì—ì„œëŠ” ìŠ¤í‚µ)
if [ "$CURRENT_BRANCH" = "main" ] && [ -t 0 ]; then
  echo "âš ï¸  main ë¸Œëœì¹˜ë¡œ ì§ì ‘ pushí•˜ëŠ” ê²ƒì€ ê¶Œì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
  echo "ğŸ’¡ Pull Requestë¥¼ í†µí•´ ë³€ê²½ì‚¬í•­ì„ ê²€í† í•˜ì„¸ìš”."
  echo ""
  read -p "ì •ë§ main ë¸Œëœì¹˜ë¡œ pushí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (yes/no): " -r
  if [ "$REPLY" != "yes" ]; then
    echo "âŒ Pushê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."
    exit 1
  fi
  echo "âš ï¸  ê°•ì œ pushë¥¼ ì§„í–‰í•©ë‹ˆë‹¤..."
fi

# ë¦°í„° ì‹¤í–‰ (í•„ìˆ˜)
echo "ğŸ” Running linter..."
npx turbo run lint || {
  echo "âŒ Linter failed. Please fix the errors before pushing."
  exit 1
}

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ì„ íƒì  - ì‹¤íŒ¨í•´ë„ ê³„ì† ì§„í–‰)
echo "ğŸ§ª Running tests..."
npx turbo run test || {
  echo "âš ï¸  Tests failed, but continuing with push..."
  echo "ğŸ’¡ Tests will run in GitHub Actions."
}

echo "âœ… Pre-push checks completed!"

